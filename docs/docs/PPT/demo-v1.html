<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pi0.6 与 RECAP 算法原理解析</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/plugin/math/math.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reset.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/theme/black.min.css">
    
    <!-- Custom Styles -->
    <style>
        .reveal h1, .reveal h2, .reveal h3, .reveal h4 {
            text-transform: none;
            color: #61dafb;
        }
        .reveal p, .reveal li, .reveal td {
            font-size: 0.75em;
            line-height: 1.6;
            color: #e0e0e0;
        }
        .highlight {
            color: #ffcc00;
            font-weight: bold;
        }
        .math-box {
            background: rgba(255, 255, 255, 0.08);
            padding: 15px;
            border-radius: 10px;
            border-left: 5px solid #61dafb;
            margin: 15px 0;
            font-size: 0.85em;
            text-align: left;
        }
        /* New Table Styles for Symbol Breakdown */
        .symbol-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.65em !important;
            margin-top: 10px;
        }
        .symbol-table td, .symbol-table th {
            border: 1px solid #444;
            padding: 8px;
            text-align: left;
        }
        .symbol-table th {
            background-color: #333;
            color: #61dafb;
        }
        .symbol-col { width: 15%; font-weight: bold; color: #ffcc00; }
        .meaning-col { width: 35%; }
        .analogy-col { width: 50%; color: #aaa; font-style: italic; }

        .analogy-box {
            background: #2b3a42;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px dashed #61dafb;
        }
        
        .logic-step {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        .logic-box {
            background: #2b2b2b;
            padding: 15px;
            border-radius: 8px;
            width: 30%;
            font-size: 0.7em;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .arrow { font-size: 2em; color: #61dafb; }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <!-- Title Slide -->
            <section>
                <h2>从 $\pi$ 到 $\pi_{0.6}$</h2>
                <h3>基于 RECAP 的 VLA 模型进化之路</h3>
                <p style="margin-top: 50px; color: #888;">算法核心公式详解版</p>
            </section>

            <!-- Overview Flow -->
            <section>
                <h3>核心逻辑概览</h3>
                <div class="logic-step">
                    <div class="logic-box">
                        <h4 style="color:#ff9999">1. 价值函数 (Critic)</h4>
                        <p>判断局面好坏</p>
                    </div>
                    <div class="arrow">➡</div>
                    <div class="logic-box">
                        <h4 style="color:#99ff99">2. 优势计算 (Advantage)</h4>
                        <p>找出关键动作</p>
                    </div>
                    <div class="arrow">➡</div>
                    <div class="logic-box">
                        <h4 style="color:#99ccff">3. 策略提取 (Actor)</h4>
                        <p>只学好的，不学坏的</p>
                    </div>
                </div>
            </section>

            <!-- Formula 1: Value Function - The Formula -->
            <section>
                <h4>公式一：分布式价值函数</h4>
                <p>我们首先需要一个能看懂局势的“教练”。</p>
                <div class="math-box">
                    $$p_{\phi}(V | o_t, l) \in \Delta_B$$
                </div>
                
                <table class="symbol-table">
                    <thead>
                        <tr><th>符号</th><th>数学含义</th><th>通俗解释</th></tr>
                    </thead>
                    <tbody>
                        <tr><td class="symbol-col">$p_{\phi}$</td><td>参数为$\phi$的概率分布</td><td>我们的<strong>AI裁判大脑</strong>（神经网络）。</td></tr>
                        <tr><td class="symbol-col">$V$</td><td>Value (价值)</td><td><strong>距离成功还有多远</strong>（负步数）。</td></tr>
                        <tr><td class="symbol-col">$o_t, l$</td><td>Observation, Language</td><td><strong>现在的处境</strong>（看到图）和<strong>任务目标</strong>（指令）。</td></tr>
                        <tr><td class="symbol-col">$\Delta_B$</td><td>B个区间的分布</td><td><strong>不是给一个死分数</strong>，而是给一个概率图。</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Formula 1: Value Function - Example -->
            <section>
                <h4>公式一：通俗理解与例子</h4>
                <div class="analogy-box">
                    <p><strong>生活例子：</strong> 篮球比赛还剩 2 分钟，落后 5 分。</p>
                    <hr style="border-color: #555; margin: 10px 0;">
                    <ul>
                        <li><strong>$o_t$ (现状):</strong> 看到队友拿着球，对方防守很严。</li>
                        <li><strong>$l$ (目标):</strong> “赢得比赛”。</li>
                        <li><strong>$p_{\phi}(V)$ (AI裁判):</strong> 它不会只说“能赢”或“输”，而是说：
                            <br>
                            <span style="color:#ffcc00">"30%概率赢 (V高)，50%概率输 (V低)，20%加时。"</span>
                        </li>
                    </ul>
                </div>
                <p style="margin-top:20px; font-size:0.7em;"><strong>为什么这很重要？</strong> <br>因为机器人世界充满不确定性，预测一个“分布”比预测一个“绝对值”更靠谱，能让机器人知道风险在哪里。</p>
            </section>

            <!-- Formula 2: Advantage - The Formula -->
            <section>
                <h4>公式二：优势函数 (Advantage)</h4>
                <p>知道了局势好坏，怎么判断刚才那一步<strong>走得对不对</strong>？</p>
                <div class="math-box">
                    $$A^{\pi}(o_t, a_t) = \underbrace{R(\tau)}_{\text{实际结果}} - \underbrace{V^{\pi}(o_t)}_{\text{预期平均值}}$$
                </div>
                
                <table class="symbol-table">
                    <thead>
                        <tr><th>符号</th><th>数学含义</th><th>通俗解释</th></tr>
                    </thead>
                    <tbody>
                        <tr><td class="symbol-col">$A$</td><td>Advantage (优势)</td><td><strong>惊喜值</strong>：这一步比平常表现好多少？</td></tr>
                        <tr><td class="symbol-col">$a_t$</td><td>当前动作</td><td><strong>你刚才做的决定</strong>。</td></tr>
                        <tr><td class="symbol-col">$R(\tau)$</td><td>这一局的实际回报</td><td><strong>期末考试的真实分数</strong>。</td></tr>
                        <tr><td class="symbol-col">$V^{\pi}$</td><td>当前状态的价值</td><td><strong>全班平均分</strong>（或者你平时的平均水平）。</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Formula 2: Advantage - Example -->
            <section>
                <h4>公式二：通俗理解与例子</h4>
                <div class="analogy-box">
                    <p><strong>生活例子：</strong> 还是那场篮球赛。</p>
                    <hr style="border-color: #555; margin: 10px 0;">
                    <ul>
                        <li><strong>$V^{\pi}(o_t)$ (预期):</strong> 在这个位置投篮，通常命中率 40% (期望得 0.8 分)。</li>
                        <li><strong>情景 A (好动作):</strong> 你传出了一个绝妙好球，队友空位得分 (得 2 分)。
                            <br>$\rightarrow A = 2 - 0.8 = \mathbf{+1.2}$ (正优势，好球！)</li>
                        <li><strong>情景 B (坏动作):</strong> 你强行投篮被盖帽 (得 0 分)。
                            <br>$\rightarrow A = 0 - 0.8 = \mathbf{-0.8}$ (负优势，臭棋。)</li>
                    </ul>
                </div>
                <p style="margin-top:20px; font-size:0.7em;"><strong>总结：</strong> $A > 0$ 代表这一步做得比平均水平好，我们需要把它<strong>标记为“好数据”</strong>。</p>
            </section>

            <!-- Formula 3: Policy Extraction - The Formula -->
            <section>
                <h4>公式三：策略提取 (最核心公式)</h4>
                <p>怎么让模型只学“好动作”，忘掉“坏动作”？</p>
                <div class="math-box">
                    $$\hat{\pi}(a|o) \propto \pi_{ref}(a|o) \underbrace{\left( \frac{\pi_{ref}(a|\mathbf{I=True}, o)}{\pi_{ref}(a|o)} \right)^\beta}_{\text{增强系数}}$$
                </div>

                <table class="symbol-table">
                    <thead>
                        <tr><th>符号</th><th>数学含义</th><th>通俗解释</th></tr>
                    </thead>
                    <tbody>
                        <tr><td class="symbol-col">$\hat{\pi}$</td><td>优化后的新策略</td><td><strong>进化后的超级机器人</strong>。</td></tr>
                        <tr><td class="symbol-col">$\pi_{ref}$</td><td>参考策略(旧策略)</td><td><strong>现在的机器人</strong>（有时候笨，有时候聪明）。</td></tr>
                        <tr><td class="symbol-col">$I=True$</td><td>条件：优势为正</td><td><strong>提示词：“只看那些成功的案例”。</strong></td></tr>
                        <tr><td class="symbol-col">$\beta$</td><td>温度/强度系数</td><td><strong>滤镜强度</strong>：$\beta$ 越大，越只准做最完美的动作。</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Formula 3: Policy Extraction - Example -->
            <section>
                <h4>公式三：通俗理解与例子</h4>
                <div class="analogy-box">
                    <p><strong>通俗逻辑：</strong> 贝叶斯推断。</p>
                    <p>
                        $$ \text{新策略} = \text{旧习惯} \times \text{成功修正因子} $$
                    </p>
                    <hr style="border-color: #555; margin: 10px 0;">
                    <ul>
                        <li>假设机器人平时倒咖啡（$\pi_{ref}$），50% 倒进杯子，50% 倒在桌上。</li>
                        <li>当我们加上条件 $I=True$（只看成功的录像）时，倒进杯子的概率变成了 99%。</li>
                        <li>公式的作用就是：在推理时，<strong>强迫</strong>模型假设自己处于“成功模式”，从而把那 99% 的动作概率提取出来。</li>
                    </ul>
                </div>
            </section>

            <!-- Formula 4: Flow Matching / CFG -->
            <section>
                <h4>公式四：实际推理 (CFG 引导)</h4>
                <p>在实际控制机械臂时，怎么把上面的数学变成代码？</p>
                <div class="math-box">
                    $$ a_{final} = a_{uncond} + \beta \cdot (a_{cond} - a_{uncond}) $$
                </div>
                
                <table class="symbol-table">
                    <thead>
                        <tr><th>符号</th><th>含义</th><th>解释</th></tr>
                    </thead>
                    <tbody>
                        <tr><td class="symbol-col">$a_{uncond}$</td><td>无条件输出</td><td>机器人<strong>下意识</strong>的动作（可能好可能坏）。</td></tr>
                        <tr><td class="symbol-col">$a_{cond}$</td><td>有条件输出</td><td>机器人<strong>努力想要成功</strong>时的动作（输入了"Advantage: Positive"）。</td></tr>
                        <tr><td class="symbol-col">$\beta$</td><td>引导强度</td><td><strong>放大器</strong>。</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Formula 4: Visual Example -->
            <section>
                <h4>公式四：直观图解</h4>
                <div style="display: flex; align-items: center; justify-content: space-around;">
                    <div style="background:#333; padding:10px; width:30%;">
                        <p>🐕 普通狗<br>($a_{uncond}$)</p>
                    </div>
                    <div style="font-size:2em;">+</div>
                    <div style="background:#333; padding:10px; width:30%;">
                        <p>✨ 想要变可爱<br>($a_{cond} - a_{uncond}$)</p>
                    </div>
                    <div style="font-size:2em;">=</div>
                    <div style="background:#61dafb; color:#000; padding:10px; width:30%; font-weight:bold;">
                        <p>🐩 超级可爱狗<br>($a_{final}$)</p>
                    </div>
                </div>
                <div class="analogy-box" style="margin-top:20px;">
                    <p><strong>机器人语境：</strong></p>
                    <p>“普通动作”是把杯子拿起来（稍微有点抖）。</p>
                    <p>“成功意图”的区别是手抓得更稳。</p>
                    <p><strong>结果：</strong> 我们把“抓得更稳”这个特征放大 $\beta$ 倍，叠加到动作上，机器人就做出了极其稳定的抓取动作。</p>
                </div>
            </section>

            <!-- Summary -->
            <section>
                <h3>总结：一句话串联所有公式</h3>
                <div style="text-align:left; font-size:0.9em; margin: 20px 10%; background: #222; padding: 20px; border-radius: 10px;">
                    <p>1. <strong>$p(V)$</strong> 是裁判，给现在的局面打分。</p>
                    <p>2. <strong>$A = R - V$</strong> 算出这一步是不是“神来之笔”。</p>
                    <p>3. <strong>$I=True$</strong> 像一个过滤器，只保留那些“神来之笔”。</p>
                    <p>4. <strong>$CFG$</strong> 在最后执行时，把这些“神来之笔”的特征放大，让机器人超水平发挥。</p>
                </div>
            </section>

        </div>
    </div>

    <script>
        Reveal.initialize({
            hash: false,
            history: false,
            transition: 'convex',
            math: {
                mathjax: 'https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js',
                config: 'TeX-AMS_HTML-full',
                TeX: { Macros: { RR: "{\\bf R}" } }
            },
            plugins: [ RevealMath ]
        });
    </script>
</body>
</html>