# 📂 文件清单与快速导航

## 🎯 核心文件说明

### 推理脚本
**test_infer_v3.py** - 挖掘机推理脚本（关键）
- ✅ 完整的数据加载管道
- ✅ 从 parquet 格式读取 LeRobot 数据
- ✅ WebSocket 客户端与推理服务通信
- ✅ 数据验证 5 步框架
- ✅ 推理结果分析和可视化
- ✅ 生成 5 类输出（PNG、CSV、JSON）

**quick_diagnosis.py** - 快速诊断脚本
- 自动性能分析
- 数据分布检查
- 预测质量评估
- 诊断结论生成

**angle_wrapping_diagnosis.py** - 角度包装诊断
- 检测 ±π 边界跨越
- 计算循环距离改进
- 样本级别分析

**verify_training_data.py** - 数据验证脚本
- 数据集结构检查
- 维度验证
- 统计分析

### 配置文件
**config.py** - 训练配置（已修改）
- LeRobotExcavatorDataConfig
- pi05_excavator_finetune 完整配置
- 学习率调度
- 冻结策略

**droid_policy.py** - 数据处理类（已修改）
- ExcavatorInputs（新增）
- ExcavatorOutputs（新增）
- 图像处理管道

---

## 📊 输出文件说明

### v3_stats.json
```json
{
  "总样本数": 1300,
  "有效样本数": 1300,
  "关节": ["大臂 (Boom)", "小臂 (Arm)", "铲斗 (Bucket)", "回转 (Swing)"],
  "MAE": [0.257, 0.313, 1.018, 1.185],
  "RMSE": [0.312, 0.370, 1.203, 2.194]
}
```

### v3_predictions.csv
- 1300 行推理结果
- 时间戳、4个关节的真实值、预测值

### PNG 可视化
- **v3_1_time_series.png** - 4个关节的时序图
- **v3_2_error_analysis.png** - 误差分析（箱线图）
- **v3_3_error_distribution.png** - 误差分布直方图

---

## 🔍 快速查找表

### 我想...

**了解 test_infer_v3.py 如何工作**
→ 查看本文档"核心文件说明"中的脚本说明
→ 查看 [1] QUICKSTART_V3.md 的"完整流程"部分

**修改推理脚本以应用角度包装修复**
→ 查看 [1] QUICKSTART_V3.md 的"步骤1"
→ 在 test_infer_v3.py 中找到 MAE 计算位置
→ 添加 apply_angle_wrapping 函数

**理解输出文件格式**
→ 本文档的"输出文件说明"部分

**验证训练数据质量**
→ 运行 verify_training_data.py
→ 查看 [1] QUICKSTART_V3.md 的"前置条件检查"

**进行全面诊断**
→ 运行 quick_diagnosis.py 或 angle_wrapping_diagnosis.py
→ 查看 [4] 诊断脚本使用指南.md

---

## 📁 文件组织

### doc/v3 目录结构
```
doc/v3/
├── 核心文档/
│   ├── [0] 📚_阅读指南.md                  - 导航总入口
│   ├── [1] QUICKSTART_V3.md                 - 快速开始
│   ├── [2] 角度包装问题详解.md              - 问题B分析
│   ├── [3] 完整问题诊断与修复方案.md        - 完整修复
│   └── [4] 诊断脚本使用指南.md              - 工具说明
│
├── 参考文档/
│   ├── [5] FILES_DESCRIPTION.md             - 本文档
│   ├── [6] MODIFICATION_SUMMARY.md          - 5个问题+5个改进
│   ├── [7] V2_VS_V3_COMPARISON.md           - 版本对比
│   └── [8] test_infer_v3_设计说明.md       - 脚本详解
│
└── 特殊说明/
    ├── README_重新整理说明.txt
    └── angle_wrapping_diagnosis.py（脚本）
```

---

## 🎯 按用途查找

### 我是新手，不知道从哪开始
```
[0] 📚_阅读指南.md
  ↓
选择推荐路线
  ↓
按路线阅读对应文档
```

### 我只想快速修复 J4
```
[1] QUICKSTART_V3.md - 第1部分
  ↓
5分钟完成修复
```

### 我想理解为什么会出现这些问题
```
[2] 角度包装问题详解.md（问题B）
[3] 完整问题诊断与修复方案.md（问题A）
```

### 我想看 test_infer_v3.py 如何构造
```
[8] test_infer_v3_设计说明.md
  ↓
了解完整的设计思路和代码结构
```

### 我想对比改进前后的差异
```
[6] MODIFICATION_SUMMARY.md
[7] V2_VS_V3_COMPARISON.md
```

### 我想使用诊断工具
```
[4] 诊断脚本使用指南.md
```

---

## 📊 重要信息索引

| 话题 | 文档 | 位置 |
|------|------|------|
| 推理脚本设计 | [8] | 全文 |
| 问题 A 详解 | [3] | 第一部分 |
| 问题 B 详解 | [2] | 全文 |
| 快速修复代码 | [1] | 步骤1 |
| 完整修复代码 | [3] | 修复方案A |
| 诊断工具使用 | [4] | 全文 |
| 改进对比 | [6], [7] | 全文 |
| 学习时间线 | [0] | 推荐路线 |

---

**这是参考文档 - 配合核心文档[0-4]使用效果最佳**
